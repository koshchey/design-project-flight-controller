\subsection{System Integration}

The firmware and hardware were co-designed to ensure seamless integration, with all peripherals and control structures mapped directly to hardware interfaces defined at the PCB design stage. The firmware architecture abstracts low-level hardware interaction through driver modules, allowing the stabilisation logic and control loops to operate independently of specific sensor or motor hardware as long as the communication interface remains consistent.

Integration consisted primarily of flashing the firmware onto the custom PCB and verifying that all I/O mappings aligned with the predefined pin assignments for motors, sensors, and communication interfaces. These pin mappings are fixed in hardware and therefore defined early in the design process to avoid later integration conflicts.

\textbf{Integration Scope}
\begin{itemize}
    \item Flight controller (ESP32) interfaced with IMU, ToF sensor, and motor drivers via I\textsuperscript{2}C, UART, and PWM.
    \item Power distribution validated across battery input, onboard regulators, and USB programming rail.
    \item Mechanical frame provides physical constraints for airflow, sensor line-of-sight, and connector accessibility.
    \item WebSocket communication used to validate telemetry and control signal flow during integration testing.
\end{itemize}

\begin{table}[H]
\centering
\renewcommand{\arraystretch}{1.2}
\begin{tabular}{|p{4cm}|p{9cm}|}
\hline
\rowcolor{gray!15}
\textbf{Subsystem} & \textbf{Integration Checkpoint} \\
\hline
Motor Control & PWM outputs verified against PCB pinout; each channel tested via serial command to confirm expected rotation. \\
\hline
Sensor Interfaces & IMU and ToF sensor initialisation confirmed over I\textsuperscript{2}C with valid data streaming into state estimator. \\
\hline
Power System & USB priority over battery verified; 3.3\,V rail checked under load during active sensor and Wi-Fi transmission. \\
\hline
Communication Link & WebSocket telemetry and setpoint commands validated \\
\hline
Mechanical Fit & PCB alignment, connector access, and sensor line-of-sight confirmed within frame tolerances. \\
\hline
\end{tabular}
\caption{System-Level Integration Verification Points}
\label{tab:system-integration}
\end{table}

\noindent All subsystems were integrated according to version-controlled interface definitions, and validated sequentially through subsystem and combined functional testing. Final system integration is shown in Fig.~\ref{fig:complete-drone}.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.7\textwidth]{img/frame-placeholder.png}
    \caption{Completed Integrated Drone System \temp{placeholder}}
    \label{fig:complete-drone}
\end{figure}

\temp{Add firmware figures mayhaps}
%-------------------------------------------------------------% 
\pagebreak
\include{2_body/design/stakeholder}

\pagebreak
\include{2_body/design/safety-ethical-risk}

\pagebreak
\include{2_body/design/assembly}

%-------------------------------------------------------------% 
\subsection{Design Outputs}
\textbf{Stored at:} \url{https://github.com/koshchey/design-project-flight-controller}

\textbf{Repository Contents:}
\begin{itemize}
    \item \texttt{ELEC5552\_FinalReport\_Team0.pdf}: This report.
    \item \texttt{Final\_Report\_LaTeX/}: Contains all \LaTeX{} source files.
    \item \texttt{Firmware/}: Flight controller firmware (\gls{esp-idf} project).
    \item \temp{To-add}
\end{itemize}

%-------------------------------------------------------------% 
\subsection{Final Costs}
\section{Budget and Cost Analysis}

To maintain a budget of over \$350 (R.23), and satisfy the usual assessor requirements (traceable BOM, evidence, margin, risks), mass production amortises one-off fees, lowering unit cost. Costs per unit are shown below depending on the production scale:

\begin{table}[H]
\centering
\begin{tabular}{l c}
\toprule
\textbf{Number of Drones Produced} & \textbf{Cost per Unit} \\
\midrule
1 unit   & \$75.15 \\
10 units & \$33.51 \\
100 units & \$29.34 \\
\bottomrule
\end{tabular}
\caption{Unit costs depending on production scale.}
\end{table}

\subsection{PCB Fabrication}

Fabrication \& Assembly is performed by JLCPCB (2-layer, top-side assembly only, 2.6mm thickness, green standard colour). Top-side mounting only reduces assembly fee and simplifies rework/inspection; PCB cost is therefore split into fabrication and loose parts. Shipping and handling cost \$18.

\begin{table}[H]
\centering
\begin{tabular}{l r}
\toprule
\textbf{Items} & \textbf{Price} \\
\midrule
Merchandise Total (5x PCB mounted: PCB, Components, Manual handling) & \$67.92 \\
Total (for 5 PCBs) & \$67.92 \\
Total (Per PCB) & \$13.58 \\
\bottomrule
\end{tabular}
\caption{PCB fabrication and assembly cost breakdown. Full BOM and Gerbers for top surface mount components are in the Appendix.}
\end{table}

\subsection{Additional Surface-Mounted Components}

Cost of recommended parts for one fully mounted PCB (LCSC supplier). Shipping and handling \$13.27 per purchase.

\begin{table}[H]
\centering
\begin{tabular}{l c r}
\toprule
\textbf{Item} & \textbf{Qty} & \textbf{Per Unit (\$)} \\
\midrule
ESP32 module (WROOM/compatible) & 1 & 4.33 \\
10 µF MLCC cut tape (100 pcs) & 1 & 0.0029 \\
100 nF MLCC cut tape (100 pcs) & 1 & 0.0024 \\
2.54 mm female headers (4 pin) & 2 sets & 2.86 \\
Solder wire & 1 & 0.50 \\
Toggle Switch – High current & 1 & 2.50 \\
Insulated Wire & 1 & 0.105 \\
\midrule
\textbf{Total (Per Drone)} & & 10.30 \\
\bottomrule
\end{tabular}
\caption{Cost breakdown of additional surface-mounted components.}
\end{table}

\subsection{3D Printed Frame Cost}

Material: Entire frame printed in PETG with raft and tree supports (7\% gyroid infill). No shipping costs (local vendor in Perth). Cost includes filament used for supports. Printer usage is \$0.

\begin{table}[H]
\centering
\begin{tabular}{l c r}
\toprule
\textbf{Item} & \textbf{Qty} & \textbf{Per Unit (\$)} \\
\midrule
Filament & 70g & 1.40 \\
\bottomrule
\end{tabular}
\caption{3D printed frame material cost.}
\end{table}

\subsection{Motor and Battery Cost}

Batteries and motors/propellers are purchased commercially for safety and compliance. Average shipping \$15 per purchase.

\begin{table}[H]
\centering
\begin{tabular}{l c r}
\toprule
\textbf{Item} & \textbf{Qty} & \textbf{Per Unit (\$)} \\
\midrule
Battery 1S 800mAH & 1 & 4.89 \\
Motors + Propellers (1 set = 2x ACW, 2x CW) & 1 set & 5.59 \\
JST male connectors / crimps & 4 & 0.103 \\
\bottomrule
\end{tabular}
\caption{Motor and battery cost breakdown. Recommended items and vendors listed in Appendix.}
\end{table}

\subsection{Total Price Breakdown for Manufacturing}

\begin{table}[H]
\centering
\begin{tabular}{l r}
\toprule
\textbf{Costs} & \textbf{Price Per Unit (\$)} \\
\midrule
PCB; top face assembled & 13.58 \\
Additional Components & 10.30 \\
3D Printed Frame & 1.40 \\
\midrule
\textbf{Total per Drone for Parts} & 28.88 \\
PCB Shipping Charge & 18.00 \\
Shipping and Handling (Components) & 13.27 \\
Shipping and Handling (Motors \& Battery) & 15.00 \\
\midrule
\textbf{Total Fees Per Production} & 46.27 \\
\bottomrule
\end{tabular}
\caption{Complete cost breakdown including parts and shipping/handling.}
\end{table}
